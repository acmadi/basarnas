-- please apply_this_first.sql
USE db_asset_basarnas;

UPDATE ext_asset_angkutan SET kode_unor = 73, kd_klasifikasi_aset="040306"
WHERE kd_lokasi="107010199414370000KP" AND kd_brg="3020101002" AND no_aset>=7 AND no_aset<=10; -- Barang ini (4 mobil kom) Punya dirComp

INSERT INTO asset_alatbesar (kd_lokasi, kd_brg, no_aset, kuantitas, jns_trn, `type`, merk, kondisi, rph_aset, tgl_buku, tgl_prl, dari, dasar_hrg, no_kib)
(
	SELECT kd_lokasi, kd_brg, no_aset, kuantitas, jns_trn, keterangan, merk_type, kondisi, rph_aset, tgl_buku, tgl_perlh, asal_perlh, dsr_hrg, no_aset FROM t_masteru 
	WHERE (kd_lokasi, kd_brg, no_aset) IN (
		("107010199414370000KP","3060201017",4),
		("107010199414370000KP","3060347003",29),
		("107010199414370000KP","3150405001",5),
		("107010199414370000KP","3030103001",102),
		("107010199414370000KP","3030301072",185),
		("107010199414370000KP","3050206072",979),
		("107010199414370000KP","3060101048",135),
		("107010199414370000KP","3030205019",4),
		("107010199414370000KP","3080802002",4),
		("107010199414370000KP","3150302999",780),
		("107010199414370000KP","3100204027",6),
		("107010199414370000KP","3060204001",6),
		("107010199414370000KP","3060203001",8),
		("107010199414370000KP","3060204001",10),
		("107010199414370000KP","3060201006",545),
		("107010199414370000KP","3060201006",546),
		("107010199414370000KP","3030317023",4),
		("107010199414370000KP","3100102001",183),
		("107010199414370000KP","3100204004",6),
		("107010199414370000KP","3060209012",20),
		("107010199414370000KP","3060209012",21),
		("107010199414370000KP","3060209012",22),
		("107010199414370000KP","3060209012",23),
		("107010199414370000KP","3150405003",39),
		("107010199414370000KP","3060347004",100),
		("107010199414370000KP","3060347004",101),
		("107010199414370000KP","3060347004",102),
		("107010199414370000KP","3060347004",103),
		("107010199414370000KP","3060347004",104),
		("107010199414370000KP","3060347004",105),
		("107010199414370000KP","3060347004",106),
		("107010199414370000KP","3060347004",107),
		("107010199414370000KP","3060347004",108),
		("107010199414370000KP","3060347004",109),
		("107010199414370000KP","3060347004",95),
		("107010199414370000KP","3060347004",96),
		("107010199414370000KP","3060347004",97),
		("107010199414370000KP","3060347004",98),
		("107010199414370000KP","3060347004",99),
		("107010199414370000KP","3060347004",35),
		("107010199414370000KP","3060347004",36),
		("107010199414370000KP","3060347004",37),
		("107010199414370000KP","3060347004",38),
		("107010199414370000KP","3060347004",39),
		("107010199414370000KP","3060347004",40),
		("107010199414370000KP","3060347004",41),
		("107010199414370000KP","3060347004",42),
		("107010199414370000KP","3060347004",43),
		("107010199414370000KP","3060347004",44),
		("107010199414370000KP","3150405009",17),
		("107010199414370000KP","3150405009",18),
		("107010199414370000KP","3150405009",19),
		("107010199414370000KP","3150405009",20),
		("107010199414370000KP","3150405009",21),
		("107010199414370000KP","3150405009",22),
		("107010199414370000KP","3150405009",23),
		("107010199414370000KP","3150405009",24),
		("107010199414370000KP","3150405009",25),
		("107010199414370000KP","3150405009",26),
		("107010199414370000KP","3150405009",27),
		("107010199414370000KP","3150405009",28),
		("107010199414370000KP","3150405009",29),
		("107010199414370000KP","3150405009",30),
		("107010199414370000KP","3150405009",31),
		("107010199414370000KP","3150405009",32),
		("107010199414370000KP","3150405009",33),
		("107010199414370000KP","3150405009",34),
		("107010199414370000KP","3150405009",35),
		("107010199414370000KP","3150405009",36),
		("107010199414370000KP","3150405009",37),
		("107010199414370000KP","3150405009",38),
		("107010199414370000KP","3150405009",39),
		("107010199414370000KP","3150405009",40),
		("107010199414370000KP","3150405009",41),
		("107010199414370000KP","3150405009",42),
		("107010199414370000KP","3150405009",43),
		("107010199414370000KP","3150405009",44),
		("107010199414370000KP","3150405009",45),
		("107010199414370000KP","3150405009",46),
		("107010199414370000KP","3150405009",47),
		("107010199414370000KP","3150405009",48),
		("107010199414370000KP","3150405009",49),
		("107010199414370000KP","3150405009",50),
		("107010199414370000KP","3060340999",103),
		("107010199414370000KP","3060340999",104),
		("107010199414370000KP","3060340999",105),
		("107010199414370000KP","3060340999",106),
		("107010199414370000KP","3060340999",107),
		("107010199414370000KP","3060340999",108),
		("107010199414370000KP","3060340999",109),
		("107010199414370000KP","3060340999",110),
		("107010199414370000KP","3060340999",111),
		("107010199414370000KP","3060340999",112),
		("107010199414370000KP","3060340999",113),
		("107010199414370000KP","3060340999",114),
		("107010199414370000KP","3060320001",49),
		("107010199414370000KP","3060320001",10),
		("107010199414370000KP","3060320001",11),
		("107010199414370000KP","3060320001",12),
		("107010199414370000KP","3060320001",13),
		("107010199414370000KP","3060320001",14),
		("107010199414370000KP","3060320001",15),
		("107010199414370000KP","3060320001",16),
		("107010199414370000KP","3060320001",7),
		("107010199414370000KP","3060320001",8),
		("107010199414370000KP","3060320001",9)
	) 
	AND (kd_lokasi, kd_brg, no_aset) NOT IN (
		SELECT kd_lokasi, kd_brg, no_aset FROM asset_alatbesar
		UNION
		SELECT kd_lokasi, kd_brg, no_aset FROM asset_angkutan
		UNION
		SELECT kd_lokasi, kd_brg, no_aset FROM asset_bangunan
		UNION
		SELECT kd_lokasi, kd_brg, no_aset FROM asset_dil
		UNION
		SELECT kd_lokasi, kd_brg, no_aset FROM asset_perairan
		UNION
		SELECT kd_lokasi, kd_brg, no_aset FROM asset_ruang
		UNION
		SELECT kd_lokasi, kd_brg, no_aset FROM asset_senjata
		UNION
		SELECT kd_lokasi, kd_brg, no_aset FROM asset_tanah
	)
	AND LEFT(jns_trn,1)="1"
);

INSERT INTO ext_asset_alatbesar (kd_lokasi, kd_brg, no_aset, kode_unor)
(
	SELECT kd_lokasi, kd_brg, no_aset, 73 AS `kode_unor` FROM t_masteru 
	WHERE (kd_lokasi, kd_brg, no_aset) IN (
		("107010199414370000KP","3060201017",4),
		("107010199414370000KP","3060347003",29),
		("107010199414370000KP","3150405001",5),
		("107010199414370000KP","3030103001",102),
		("107010199414370000KP","3030301072",185),
		("107010199414370000KP","3050206072",979),
		("107010199414370000KP","3060101048",135),
		("107010199414370000KP","3030205019",4),
		("107010199414370000KP","3080802002",4),
		("107010199414370000KP","3150302999",780),
		("107010199414370000KP","3100204027",6),
		("107010199414370000KP","3060204001",6),
		("107010199414370000KP","3060203001",8),
		("107010199414370000KP","3060204001",10),
		("107010199414370000KP","3060201006",545),
		("107010199414370000KP","3060201006",546),
		("107010199414370000KP","3030317023",4),
		("107010199414370000KP","3100102001",183),
		("107010199414370000KP","3100204004",6),
		("107010199414370000KP","3060209012",20),
		("107010199414370000KP","3060209012",21),
		("107010199414370000KP","3060209012",22),
		("107010199414370000KP","3060209012",23),
		("107010199414370000KP","3150405003",39),
		("107010199414370000KP","3060347004",100),
		("107010199414370000KP","3060347004",101),
		("107010199414370000KP","3060347004",102),
		("107010199414370000KP","3060347004",103),
		("107010199414370000KP","3060347004",104),
		("107010199414370000KP","3060347004",105),
		("107010199414370000KP","3060347004",106),
		("107010199414370000KP","3060347004",107),
		("107010199414370000KP","3060347004",108),
		("107010199414370000KP","3060347004",109),
		("107010199414370000KP","3060347004",95),
		("107010199414370000KP","3060347004",96),
		("107010199414370000KP","3060347004",97),
		("107010199414370000KP","3060347004",98),
		("107010199414370000KP","3060347004",99),
		("107010199414370000KP","3060347004",35),
		("107010199414370000KP","3060347004",36),
		("107010199414370000KP","3060347004",37),
		("107010199414370000KP","3060347004",38),
		("107010199414370000KP","3060347004",39),
		("107010199414370000KP","3060347004",40),
		("107010199414370000KP","3060347004",41),
		("107010199414370000KP","3060347004",42),
		("107010199414370000KP","3060347004",43),
		("107010199414370000KP","3060347004",44),
		("107010199414370000KP","3150405009",17),
		("107010199414370000KP","3150405009",18),
		("107010199414370000KP","3150405009",19),
		("107010199414370000KP","3150405009",20),
		("107010199414370000KP","3150405009",21),
		("107010199414370000KP","3150405009",22),
		("107010199414370000KP","3150405009",23),
		("107010199414370000KP","3150405009",24),
		("107010199414370000KP","3150405009",25),
		("107010199414370000KP","3150405009",26),
		("107010199414370000KP","3150405009",27),
		("107010199414370000KP","3150405009",28),
		("107010199414370000KP","3150405009",29),
		("107010199414370000KP","3150405009",30),
		("107010199414370000KP","3150405009",31),
		("107010199414370000KP","3150405009",32),
		("107010199414370000KP","3150405009",33),
		("107010199414370000KP","3150405009",34),
		("107010199414370000KP","3150405009",35),
		("107010199414370000KP","3150405009",36),
		("107010199414370000KP","3150405009",37),
		("107010199414370000KP","3150405009",38),
		("107010199414370000KP","3150405009",39),
		("107010199414370000KP","3150405009",40),
		("107010199414370000KP","3150405009",41),
		("107010199414370000KP","3150405009",42),
		("107010199414370000KP","3150405009",43),
		("107010199414370000KP","3150405009",44),
		("107010199414370000KP","3150405009",45),
		("107010199414370000KP","3150405009",46),
		("107010199414370000KP","3150405009",47),
		("107010199414370000KP","3150405009",48),
		("107010199414370000KP","3150405009",49),
		("107010199414370000KP","3150405009",50),
		("107010199414370000KP","3060340999",103),
		("107010199414370000KP","3060340999",104),
		("107010199414370000KP","3060340999",105),
		("107010199414370000KP","3060340999",106),
		("107010199414370000KP","3060340999",107),
		("107010199414370000KP","3060340999",108),
		("107010199414370000KP","3060340999",109),
		("107010199414370000KP","3060340999",110),
		("107010199414370000KP","3060340999",111),
		("107010199414370000KP","3060340999",112),
		("107010199414370000KP","3060340999",113),
		("107010199414370000KP","3060340999",114),
		("107010199414370000KP","3060320001",49),
		("107010199414370000KP","3060320001",10),
		("107010199414370000KP","3060320001",11),
		("107010199414370000KP","3060320001",12),
		("107010199414370000KP","3060320001",13),
		("107010199414370000KP","3060320001",14),
		("107010199414370000KP","3060320001",15),
		("107010199414370000KP","3060320001",16),
		("107010199414370000KP","3060320001",7),
		("107010199414370000KP","3060320001",8),
		("107010199414370000KP","3060320001",9)
	) 
	AND (kd_lokasi, kd_brg, no_aset) NOT IN (
		SELECT kd_lokasi, kd_brg, no_aset FROM ext_asset_alatbesar
		UNION
		SELECT kd_lokasi, kd_brg, no_aset FROM ext_asset_angkutan
		UNION
		SELECT kd_lokasi, kd_brg, no_aset FROM ext_asset_bangunan
		UNION
		SELECT kd_lokasi, kd_brg, no_aset FROM ext_asset_dil
		UNION
		SELECT kd_lokasi, kd_brg, no_aset FROM ext_asset_perairan
		UNION
		SELECT kd_lokasi, kd_brg, no_aset FROM ext_asset_ruang
		UNION
		SELECT kd_lokasi, kd_brg, no_aset FROM ext_asset_senjata
		UNION
		SELECT kd_lokasi, kd_brg, no_aset FROM ext_asset_tanah
	)
	AND LEFT(jns_trn,1)="1"
);